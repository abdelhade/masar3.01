@echo off
chcp 65001 > nul
echo ========================================
echo ุงุฎุชุจุงุฑ ุงูุทุจุงุนุฉ
echo ========================================
echo.

REM ุงูุชุญูู ูู ุชุดุบูู ุงูุฎุงุฏู
echo ๐ ุงูุชุญูู ูู ุชุดุบูู ุงูุฎุงุฏู...
curl -s http://localhost:5000/health > nul 2>&1
if errorlevel 1 (
    echo โ ุงูุฎุงุฏู ูุง ูุนูู!
    echo.
    echo ูุฑุฌู ุชุดุบูู PrintAgent.exe ุฃููุงู
    pause
    exit /b 1
)
echo โ ุงูุฎุงุฏู ูุนูู
echo.

REM ุงูุญุตูู ุนูู ูุงุฆูุฉ ุงูุทุงุจุนุงุช
echo ๐ ุงูุญุตูู ุนูู ูุงุฆูุฉ ุงูุทุงุจุนุงุช...
curl -s http://localhost:5000/printers
echo.
echo.

REM ุงุฎุชุจุงุฑ ุงูุทุจุงุนุฉ
echo ๐จ๏ธ  ุฅุฑุณุงู ุทูุจ ุทุจุงุนุฉ ุชุฌุฑูุจู...
echo.
echo ูุฑุฌู ุฅุฏุฎุงู ุงุณู ุงูุทุงุจุนุฉ (ุฃู ุงุถุบุท Enter ููุทุงุจุนุฉ ุงูุงูุชุฑุงุถูุฉ):
set /p PRINTER_NAME=

if "%PRINTER_NAME%"=="" (
    echo ุงุณุชุฎุฏุงู ุงูุทุงุจุนุฉ ุงูุงูุชุฑุงุถูุฉ...
    curl -X POST http://localhost:5000/print ^
      -H "Content-Type: application/json" ^
      -d "{\"printer\":\"\",\"content\":\"================================\nุงุฎุชุจุงุฑ ุงูุทุจุงุนุฉ\n================================\nุงูุชุงุฑูุฎ: %date% %time%\n================================\n\"}"
) else (
    curl -X POST http://localhost:5000/print ^
      -H "Content-Type: application/json" ^
      -d "{\"printer\":\"%PRINTER_NAME%\",\"content\":\"================================\nุงุฎุชุจุงุฑ ุงูุทุจุงุนุฉ\n================================\nุงูุทุงุจุนุฉ: %PRINTER_NAME%\nุงูุชุงุฑูุฎ: %date% %time%\n================================\n\"}"
)

echo.
echo.
echo ========================================
echo ุชู ุฅุฑุณุงู ุทูุจ ุงูุทุจุงุนุฉ
echo ========================================
echo.
pause
